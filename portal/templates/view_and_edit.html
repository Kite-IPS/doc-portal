{% extends 'dash.html' %}

{% block inital_entry %}
<section id="home">
  <div class="space"></div>
  <form action="{% url 'view_and_edit' view_context.admission_no %}" method="POST">
    {% csrf_token %}
    <div class="entry-info">
      <div class="form-row">
        <div class="form-column">
          <label for="name_stu"><b>NAME OF THE STUDENT:</b></label>
          <input type="text" id="name_stu" name="name_stu" value="{{edit_context.student.name}}" required />
        </div>
        <br />
        <div class="form-column">
          <label for="receipt"><b>ADMISSION NO:</b></label>
          <input type="text" id="receipt" name="receipt" value="{{edit_context.admission_no}}" required />
          <!--<div id="messageContainer"></div>-->
        </div>
        <div class="form-column">
          <label for="name_prnt"><b>NAME OF THE PARENT:</b></label>
          <input type="text" id="name_prnt" name="name_prnt" value="{{edit_context.student.parent_name}}" required />
        </div>
        <div class="form-column">
          <label for="dept"><b>DEPARMENT:</b></label>
          <div class="dropdown">
            <select id="dept" name="dept" required>
              {% for dept in depts %}
              {% if dept == edit_context.student.department %}
              <option value="{{ edit_context.student.department }}" selected>{{ edit_context.student.department }}</option>
              {% else %}
              <option value="{{dept}}">{{dept}}</option>
              {% endif %}
              {% endfor %}
            </select>
            <span class="dropdown-icon"></span>
            <style>
              .dropdown {
                position: relative;
                display: block;
              }

              .dropdown select {
                -webkit-appearance: none;
                -moz-appearance: none;
                appearance: none;
                outline: none;
                border: 1px solid #ccc;
                padding: 8px 40px 8px 12px;
                font-size: 16px;
                border-radius: 4px;
                background-color: #fff;
                cursor: pointer;
                width: 70%;
              }

              .dropdown select:hover,
              .dropdown select:focus {
                border-color: #555;
              }

              .dropdown-icon {
                position: relative;
                top: 50%;
                right: 30px;
                transform: translateY(-50%);
                pointer-events: none;
              }

              /* Custom styles for the dropdown arrow icon */
              .dropdown-icon::after {
                content: "\25BC";
                font-size: 12px;
                color: #555;
              }
            </style>
          </div>
        </div>
      </div>
      <div class="form-row">
        <div class="form-column">
          <label for="contact1"><b>CONTACT INFO:</b><br />STUDENT NO:</label>
          <input type="text" id="contact1" name="contact1" required />
        </div>
        <div class="form-column">
          <br /><label for="contact2">PARENT NO:</label>
          <input type="text" id="contact2" name="contact2" required />
        </div>
        <br />
        <div class="form-column">
          <br /><label for="email">EMAIL ID:</label>
          <input type="email" class="email" id="email" name="email" required />
        </div>
        <div class="form-column">
          <br /><label for="quota"><b>QUOTA:</b></label>
          <div class="dropdown">
            <select id="quota" name="quota" required>
              <option disabled selected>--Quota--</option>
              <option value="mgnt">MANAGEMENT</option>
              <option value="govt">GOVERNMENT</option>
            </select>
            <span class="dropdown-icon"></span>
          </div>
        </div>
      </div>
    </div>
</section>

<!-- for the table -->
<div class="entry-table">
  <div class="table-container">
    <table>
      <!-- Defenition of column widths -->
      <colgroup>
        <col span="1" style="width: 10%">
        <col span="1" style="width: 35%">
        <col span="1" style="width: 15%">
        <col span="1" style="width: 12.5%">
        <col span="1" style="width: 12.5%">
        <col span="1" style="width: 15%">
      </colgroup>

      <thead>
        <tr>
          <th>S.no</th>
          <th>Documents</th>
          <th>Date</th>
          <th>Original</th>
          <th>Photocopy</th>
          <th>Quantity</th>
        </tr>
      </thead>
      <tbody>
        {% for record in edit_context.records %}
        <tr>
          <td colspan="0.5">{{ forloop.counter }}</td>
          <td>
            <p class="document_name">{{ record.document.name }}</p>
          </td>
          <td>{{ record.date }}</td>
          <td>
            <input type="hidden" class="form-check-input h3 w3" name="{{doc_name}}:original" value="off" />
            <input type="checkbox" class="form-check-input h3 w3" name="{{doc_name}}:original" />
          </td>
          <td>
            <input type="hidden" class="form-check-input h3 w3" name="{{doc_name}}:original" value="off" />
            <input type="checkbox" class="form-check-input h3 w3" name="{{doc_name}}:original" />
          </td>
          <td>
            <input type="number" value="{{record.count}}" name="{{doc_name}}:count" class="form_quantity_input" min="0"
              max="50" />
          </td>
        </tr>
        {% endfor %}
        <!-- Add more rows as needed -->
      </tbody>
    </table>
  </div>
  <!-- submit button -->
  <div class="submit-button" id="button">
    <button type="submit" class="btn btn-success m-4">Submit</button>
  </div>
</div>

</form>
{% endblock inital_entry %}


{% block edit %}
{{view_context}}
<div class="space-small"></div>
<section id="view-details">
  <div class="menu-2">
    <div class="entry-info">
      <div class="form-row">
        <div class="form-column">
          <label for="name_stu"><b>NAME OF THE STUDENT:</b></label>
          <input type="text" id="name_stu" name="name_stu" value="{{ view_context.student.name }}" disabled />
        </div>
        <br />
        <div class="form-column">
          <label for="receipt"><b>ADMISSION NO:</b></label>
          <input type="text" id="receipt" name="receipt" value="{{ view_context.admission_no }}" disabled />
          <!--<div id="messageContainer"></div>-->
        </div>
        <div class="form-column">
          <label for="name_prnt"><b>NAME OF THE PARENT:</b></label>
          <input type="text" id="name_prnt" name="name_prnt" value="{{ view_context.student.parent_name }}" disabled />
        </div>
        <div class="form-column">
          <label for="dept"><b>DEPARMENT:</b></label>
          <div class="dropdown">
            <select id="dept" name="dept" disabled>
              <option disabled selected>{{ view_context.student.department}}</option>
            </select>
            <span class="dropdown-icon"></span>
          </div>
          <style>
            .dropdown {
              position: relative;
              display: block;
            }

            .dropdown select {
              -webkit-appearance: none;
              -moz-appearance: none;
              appearance: none;
              outline: none;
              border: 1px solid #ccc;
              padding: 8px 40px 8px 12px;
              font-size: 16px;
              border-radius: 4px;
              background-color: #fff;
              cursor: pointer;
              width: 70%;
            }

            .dropdown select:hover,
            .dropdown select:focus {
              border-color: #555;
            }

            .dropdown-icon {
              position: relative;
              top: 50%;
              right: 30px;
              transform: translateY(-50%);
              pointer-events: none;
            }

            /* Custom styles for the dropdown arrow icon */
            .dropdown-icon::after {
              content: "\25BC";
              font-size: 12px;
              color: #555;
            }
          </style>
        </div>
      </div>
      <div class="form-row">
        <div class="form-column">
          <label for="contact1"><b>CONTACT INFO:</b><br />STUDENT NO:</label>
          <input type="text" id="contact1" name="contact1" value="{{ view_context.student.student_number }}" disabled />
        </div>
        <div class="form-column">
          <br /><label for="contact2">PARENT NO:</label>
          <input type="text" id="contact2" name="contact2" value="{{ view_context.student.parent_number }}" disabled />
        </div>
        <br />
        <div class="form-column">
          <br /><label for="email">EMAIL ID:</label>
          <input type="email" class="email" id="email" name="email" value="{{ view_context.student.email }}" disabled />
        </div>
        <div class="form-column">
          <br /><label for="quota"><b>QUOTA:</b></label>
          <div class="dropdown">
            <select id="quota" name="quota" required>
              {% if view_context.student.quota %}
              <option disabled selected>GOVERNMENT</option>
              {% else %}
              <option disabled selected>MANAGEMENT</option>
              {% endif %}
            </select>
            <span class="dropdown-icon"></span>
          </div>
        </div>
      </div>
    </div>
    <!-- for the table -->
    <div class="main-table-2">
      <!-- for the table -->
      <div class="entry-table">
        <div class="table-container">
          <table id="no-edit">
            <!-- Defenition of column widths -->
            <colgroup>
              <col span="1" style="width: 10%">
              <col span="1" style="width: 40%">
              <col span="1" style="width: 15%">
              <col span="1" style="width: 10%">
              <col span="1" style="width: 10%">
              <col span="1" style="width: 15%">
            </colgroup>

            <thead>
              <tr>
                <th>S.no</th>
                <th>Documents</th>
                <th>Date</th>
                <th>Original</th>
                <th>Photocopy</th>
                <th>Quantity</th>
              </tr>
            </thead>
            <tbody>
              {% for record in view_context.records %}
              <tr>
                <td>{{ forloop.counter }}</td>
                <td>
                  <p class="document_name">{{ record.document.name }}</p>
                </td>
                <td>{{ record.date }}</td>
                <td>
                  <input type="hidden" class="form-check-input h3 w3" value="off">
                  {% if record.original %}
                  <input type="checkbox" class="form-check-input h3 w3" checked disabled>
                  {% else %}
                  <input type="checkbox" class="form-check-input h3 w3" disabled>
                  {% endif %}
                </td>
                <td>
                  <input type="hidden" class="form-check-input h3 w3" value="off">
                  {% if record.photocopy %}
                  <input type="checkbox" class="form-check-input h3 w3" checked disabled>
                  {% else %}
                  <input type="checkbox" class="form-check-input h3 w3" disabled>
                  {% endif %}
                </td>
                <td>
                  {% if record.photocopy %}
                  <input disabled readonly type="number" value="{{ record.document.count }}" class="form_quantity_input"
                    name="{{record.document.count}}" class="cell3">                    
                  {% else %}
                  <input disabled readonly type="number" value="0" class="form_quantity_input"
                    name="{{record.document.count}}" class="cell3">
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          <script>
            const numberInput = document.getElementById('quantity-box');

            let initialInputValue; // Store the initial input value

            // Add an event listener to the input field
            numberInput.addEventListener('input', function () {
              if (numberInput.value < 0) {
                numberInput.value = 0; // Set to zero if a negative value is entered
              }
            });
          </script>
        </div>
      </div>

    <!-- down menu -->
    <div class="down-menu">
      <nav>
        <ul class="pagination justify-content-center m-1 p-1">
          <li class="page-item disabled">
            <a class="page-link" href="#" tabindex="-1" aria-disabled="true">&lt;</a>
          </li>
          <li class="page-item"><a class="page-link">Version 1</a></li>
          <li class="page-item">
            <a class="page-link" href="#">&gt;</a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</section>
{% endblock edit %}