{% load static %}
<!DOCTYPE html>
<html>
<head>
  <title>Document Verification</title>
  <link rel="stylesheet" href="{% static 'css/main.css' %}">
</head>
<body>
  <header class="header">
    <img src="{% static 'image/logo.png' %}" alt="Logo" class="logo">
    <h1>KGISL INSTITUTE OF TECHNOLOGY</h1>
    <h2>ADMINISTRATIVE OFFICE</h2>
    <h2>ACKNOWLEDGEMENT RECEIPT-PARENT COPY-REGULAR ADMISSION</h2>
    <div class="search-bar">
      <input type=" number" id="receipt-number" class="search-input" placeholder="Search your RECEIPT NO here...">
      <button class="search-button" onclick="searchReceipt()">Search</button>
    </div>
  </header>
  <form action="{%  url 'home' %}" method="POST">
  <div class="info">
        <div class="form-row">
          <div class="form-column">
            <label for="name_stu">NAME OF THE STUDENT:</label>
            <input type="text" id="name_stu" name="name_stu">
          </div><br>
          <div class="form-column">
            <label for="receipt">ACK.RECEIPT NO:</label>
            <input type="text" id="phone" name="receipt">
          </div>
          <div class="form-column">
            <label for="name_prnt">NAME OF THE PARENT:</label>
            <input type="text" id="name_prnt" name="name_prnt">
          </div>
          <div class="form-column">
            <label for="dept">DEPARMENT:</label>
            <input type="text" id="dept" name="dept">
          </div>
        </div>
        <div class="form-row">
          <div class="form-column">
           <label for="contact1">CONTACT INFO:<br>STUDENT:</label>
            <input type="text" id="contact1" name="contact1"> 
          </div>
          <div class="form-column">
            <br><label for="contact2">PARENT:</label>
            <input type="text" id="contact2" name="contact2">
          </div>
        </div>
          
          <div class="form-row">
            <label for="quota">QUOTA:</label><br>
            <input type="radio" id="mgmt" name="quota" value="mgmt">
            <label for="mgmt">MANAGEMENT</label>
            
            <input type="radio" id="govt" name="quota" value="govt">
            <label for="govt">GOVERNMENT</label>
          </div>
        </div>

  </div>
  <div class="doc_info" >
          {% csrf_token %}
        <table>
          <tr>
            <th>S.no</th>
            <th>Documents</th>
            <th>Date</th>
            <th>Original</th>
            <th>Photocopy</th>
            <th>Quantity</th>
            
          </tr>
          <tbody id="table-body">       
          
        </tbody>

          
          
        </table>
      </form>
        <input type="submit" class="button" value="submit">
      
    </div>
    <script>

      // Adding date to the form fields
      var form = document.getElementsByTagName('form')[0];
      var date_field = document.createElement("input", hidden=true, name='date', value=new Date().toLocaleDateString());
      form.appendChild(date_field);

      // Generate serial number, documents, date, checkbox, and quantity columns
    function generateColumns() {
      var tableRows = document.getElementById('table-body').children;
      for (var i = 0; i < tableRows.length; i++) {
        var serialNumberCell = document.createElement('td');
        serialNumberCell.textContent = i + 1;
        tableRows[i].insertBefore(serialNumberCell, tableRows[i].firstChild);
        

        var dateCell = document.createElement('td');
        var currentDate = new Date().toLocaleDateString();
        dateCell.textContent = currentDate;
        tableRows[i].appendChild(dateCell);

        var checkboxCell = document.createElement('td');
        var checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.name = data[i] +':'+ "original";
        
        var checkboxhidden = document.createElement('input');
        checkboxhidden.type = 'hidden';
        checkboxhidden.name = data[i] +':'+ "original";
        checkboxhidden.value = 'off';
        
        checkboxCell.appendChild(checkboxhidden);
        checkboxCell.appendChild(checkbox);
        tableRows[i].appendChild(checkboxCell);
        checkboxCell.classList.add('checkboxcell');
        checkbox.classList.add('cell5');

        var checkboxCell = document.createElement('td');
        
        
        var checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.name = data[i] +':'+ "copy";

        var checkboxhidden = document.createElement('input');
        checkboxhidden.type = 'hidden';
        checkboxhidden.name = data[i] +':'+ "copy";
        checkboxhidden.value = 'off';

        checkboxCell.appendChild(checkboxhidden);
        checkboxCell.appendChild(checkbox);
        tableRows[i].appendChild(checkboxCell);
        checkboxCell.classList.add('checkboxcell');
        checkbox.classList.add('cell5');


        var quantityCell = document.createElement('td');
        var quantityInput = document.createElement('input');
        quantityInput.type = 'number';
        quantityInput.min = '0';
        quantityInput.value = '0';
        quantityInput.name = data[i] +':'+ "count";
        quantityCell.appendChild(quantityInput);
        tableRows[i].appendChild(quantityCell);
        quantityCell.classList.add('cell4');
        quantityInput.classList.add('cell3');
      }
    }

    // Example data for the table
    var data = [
    {% for name in file_names%}  
    '{{name}}',
    {% endfor %}
    ];

    // Generate table rows
    var tableBody = document.getElementById('table-body');
    for (var i = 0; i < data.length; i++) {
      var row = document.createElement('tr');
      var dataCell = document.createElement('td');
      dataCell.textContent = data[i];
      row.appendChild(dataCell);
      tableBody.appendChild(row);
    }

    // Call the function to generate serial numbers, dates, checkboxes, and quantities
    generateColumns();

    //search function
    function searchReceipt() {
      var receiptNumber = document.getElementById("receipt-number").value;
      //additional processing with the receipt number if needed

      // Store the search value in session storage
      sessionStorage.setItem('searchValue', receiptNumber);

      // Redirect the user to the next page
      window.location.href = ""; // Replace "next-page.html" with the actual URL of the next page
    }

    function populateSearchValue() {
      var searchValue = sessionStorage.getItem('searchValue');
      if (searchValue) {
        document.getElementById("receipt-number").value = searchValue;
      }
    }

    populateSearchValue();

      </script>
  </body>
  </html>